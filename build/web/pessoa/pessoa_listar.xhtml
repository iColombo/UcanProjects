<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="../template/masterPage.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"                
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:define name="menuHorizontal">
        <ui:include src="pessoa_menu_horizontal.xhtml"/>
    </ui:define>

    <ui:define name="menuLateral">
        <ui:include src="pessoa_menu_lateral.xhtml"/>
    </ui:define>

    <ui:define name="center">
        <h2>Pessoas > Listagens</h2>
        <h:form id="PessoaListForm">

            <div class="ui-fluid">

                <p:growl showDetail="true">
                    <p:autoUpdate />
                </p:growl>

                <p:messages showSummary="true" closable="true" showDetail="true">
                    <p:autoUpdate />
                </p:messages> 

                <br />

                <p:fieldset legend="Lista de Pessoas">

                    <p:commandButton
                        icon="ui-icon-plus"  
                        onclick="PF('PessoaCreateDialog').show();"
                        style="margin-top: 5px; margin-bottom: 10px"
                        update=":PessoaCreateForm"
                        />

                    <p:dataTable 
                        id="tabela_listar_pessoa" 
                        sortMode="multiple" 
                        var="item" 
                        rows="8" 
                        paginator="true" 
                        paginatorPosition="bottom" 
                        value="#{pessoaManagedBean.listaDePessoas}"   
                        reflow="true" 
                        emptyMessage="Nenhum registo encontrado." 
                        selection="#{pessoaManagedBean.pessoa}"
                        selectionMode="single" 
                        rowKey="#{item.pkPessoa}"
                        >
                        <p:column 
                            headerText="NÃºmero de Contribuinte" 
                            sortBy="#{item.numeroContribuinte}" 
                            filterBy="#{item.numeroContribuinte}" 
                            filterMatchMode="contains"
                            >
                            <center>
                                <h:outputText 
                                    value="#{item.numeroContribuinte}"
                                    />
                            </center>
                        </p:column>                            
                        <p:column 
                            headerText="Nome" 
                            sortBy="#{item.nomeCompleto}" 
                            filterBy="#{item.nomeCompleto}" 
                            filterMatchMode="contains"
                            >
                            <center>
                                <h:outputText 
                                    value="#{item.nomeCompleto}"
                                    />
                            </center>
                        </p:column>
                        <p:column 
                            headerText="Data de Nascimento" 
                            sortBy="#{item.dataNascimento}" 
                            filterBy="#{item.dataNascimento}" 
                            filterMatchMode="contains"
                            >
                            <center>
                                <h:outputText 
                                    value="#{item.dataNascimento}"
                                    />
                            </center>
                        </p:column>                            
                        <p:column 
                            headerText="Pai" 
                            sortBy="#{item.nomePai}" 
                            filterBy="#{item.nomePai}" 
                            filterMatchMode="contains"
                            >
                            <center>
                                <h:outputText 
                                    value="#{item.nomePai}"
                                    />
                            </center>
                        </p:column>                            
                        <p:column 
                            headerText="MÃ£e" 
                            sortBy="#{item.nomeMae}" 
                            filterBy="#{item.nomeMae}" 
                            filterMatchMode="contains"
                            >
                            <center>
                                <h:outputText 
                                    value="#{item.nomeMae}"
                                    />
                            </center>
                        </p:column> 

                        <p:column 
                            headerText="-------" 
                            >
                            <center>                                   
                                <p:commandButton
                                    icon="ui-icon-info"
                                    onclick="PF('PessoaViewDialog').show();"
                                    style="margin-right: 5px; width: 20px; height: 20px"
                                    update=":PessoaViewForm"
                                    />
                                <p:commandButton 
                                    icon="ui-icon-pencil" 
                                    onclick="PF('PessoaEditDialog').show();"
                                    style="margin-right: 5px; width: 20px; height: 20px"
                                    update=":PessoaEditForm"
                                    />
                                <p:commandButton 
                                    icon="ui-icon-trash"                                    
                                    onclick="PF('confirm_dialog').show()"
                                    style="width: 20px; height: 20px"
                                    />                    
                            </center>  
                        </p:column>
                    </p:dataTable>



                    <center>
                        <p:confirmDialog 
                            header="Eliminar a Pessoa"
                            message="Tem certeza que pretende eliminar o item seleccionado?"
                            responsive="true" 
                            severity="alert" 
                            widgetVar="confirm_dialog"
                            >
                            <p:commandButton
                                actionListener="#{pessoaEliminarManagedBean.eliminarRegisto()}"
                                value="Sim" 
                                process="@this" 
                                update="tabela_listar_pessoa"
                                oncomplete="PF('confirm_dialog').hide()"
                                />
                            <p:commandButton 
                                value="NÃ£o" 
                                onclick="PF('confirm_dialog').hide();" 
                                type="button"
                                />
                        </p:confirmDialog>
                    </center>
                </p:fieldset>

            </div>

        </h:form>
        <ui:include src="pessoa_criar.xhtml"/>
        <ui:include src="pessoa_detalhe.xhtml"/>   
        <ui:include src="pessoa_editar.xhtml"/>
    </ui:define>               

</ui:composition>

